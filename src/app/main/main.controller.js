(function() {
  'use strict';

  angular
    .module('uvfelClient')
    .controller('MainController', MainController);

  /** @ngInject */
  function MainController($scope, elasticSearchService, $q, ChartService, $http, $log) {
    $scope.getLogData = [];
    $scope.charts = [];
    $scope.gridOptions = {
        enableRowSelection: false,
        enableColumnResize: true,
        enableGridMenu: true,
        infiniteScroll: true,
        rowHeight: 28,
        data: 'logData',
        columnDefs: [
            {"field":"@timestamp","displayName":"Time","minWidth":175, cellFilter: 'date:"medium"'},
            {"field":"gpsHealth","displayName":"gpsHealth","minWidth":150},
            {"field":"gpsAltitude","displayName":"gpsAltitude","minWidth":20},
            {"field":"baroAltitude","displayName":"baroAltitude","minWidth":30},
            {"field":"tickNo","displayName":"tickNo","minWidth":30, visible: false}
            // {
            //     field: 'action',
            //     displayName: 'Action',
            //     groupingShowAggregationMenu: false,
            //     enableColumnMenu: false,
            //     width: 75,
            //     pinnedRight : true,
            //     cellTemplate: 'deviceEventActionColumn.tmpl.html'
            // }

        ],
        onRegisterApi: function(gridApi){
          $scope.gridApi = gridApi;
        }
    };

    $scope.gridOptionsClimb = {
        enableRowSelection: false,
        enableColumnResize: true,
        enableGridMenu: true,
        infiniteScroll: true,
        rowHeight: 28,
        data: 'logData',
        columnDefs: [// gpsAltitude,accelZ
            {"field":"@timestamp","displayName":"Time","minWidth":175, cellFilter: 'date:"medium"'},
            {"field":"gpsAltitaccelZude","displayName":"accelZ","minWidth":150}
            // {
            //     field: 'action',
            //     displayName: 'Action',
            //     groupingShowAggregationMenu: false,
            //     enableColumnMenu: false,
            //     width: 75,
            //     pinnedRight : true,
            //     cellTemplate: 'deviceEventActionColumn.tmpl.html'
            // }

        ],
        onRegisterApi: function(gridApi){
          $scope.gridApi = gridApi;
        }
    };


    $scope.altitudeChart = {
        chart: {
            zoomType: 'x',
            height: 300
        },
        title: {
            text: 'Altitude Chart'
        },

        credits: { enabled: false },

        yAxis: {
            title: {
                text: null
            },
            min: 0
        },
        xAxis: {
            type: 'datetime',
            title: {
                text: 'Date (Local)'
            }
        },

        plotOptions: {
            series: {

            }
        },
        series: [
          {name: 'gpsHealth', data: [] },
          {name: 'gpsAltitude', data: [] },
          {name: 'baroAltitude', data: [] }
        ]
    };

  $scope.getLogData = function(data) {
    var deferred = $q.defer();
    console.log("Requesting Data");

        var queryObj = {
          size: 10000,
          sort: [
            { "@timestamp" : {"order" : "asc"}}
          ]
        };

        if (data.fromDate) {
            queryObj.filter.and[0].range.timestamp.gte = data.fromDate;
        }

        if (data.toDate) {
            queryObj.filter.and[0].range.timestamp.lte = data.toDate;
        }

        $http.post(elasticSearchService.config.getSearchUrl(elasticSearchService.config.index), queryObj)
            .then(function successCallback(response) {

            if(!response) {
                response = {data: []};
            }

            console.log("Request deffered is resolved.");
            deferred.resolve(response.data.hits.hits);
          }, function errorCallback(response) {
            $log.error('get request failed to get any data: ', response);
            deferred.resolve(response.data);
          });

        // var mockResults = [
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_Xe4","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.7153837577,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":2.58919719184,"MotorCmnd:Rback":6358.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.011,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.971658881,"MotorCmnd:LFront":7198.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.39675362319,"avgWatts":77.8200248841,"batteryCycles":0,"usefulTime":752,"magMod":1447,"directionOfTravelTrue":73.716068867,"Gimbal:XYaw":-6.03886361274,"baroAltitude":725.035705566,"maxWatts":178.53193,"Current":10.832,"Watts":154.30184,"Control:Elevator":0,"batteryLife":100,"distanceHP":6.40033588714,"MotorLoad:RFront":null,"latitude":37.2489028568,"numSats":11,"Gimbal:XPitch":3.36271147091,"MotorLoad:LFront":null,"gpsAltitude":725.134460449,"minWatts":8.26346,"Yaw":-6.02834111882,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1366,"accelZ":-1.02790522575,"magY":72,"accelY":-0.0551918707788,"magX":473,"Gimbal:Roll":0.0975004368037,"accelX":0.0286922194064,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.619463384151,"accel":1.02978567634,"gyroX":-4.72884049072,"MotorCmnd:RFront":7163.0,"gyroY":-1.1711362516,"gyroZ":0.748058539599,"velD":0.0615912377834,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.526Z","connectedToRC":1,"flightTime":45200,"velH":2.06773204541,"MotorSpeed:RFront":null,"velE":1.97275972366,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.0945239663124,"errorX":-0.315816760063,"errorZ":-0.276163160801,"geoMagInclination":65.006715539,"Control:Aileron":954,"percentageVolts":11,"quatZ":-0.0518986135721,"quatY":0.027976969257,"quatX":0.0237518064678,"quatW":0.997977793217,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7262.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.29420303707,"vel":2.06864914671,"MotorLoad:LBack":null,"longitude":-81.2506879097,"gyro":4.92880148567,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":-0.0954530542495,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.00602619916424,"Pitch":3.34591143679,"Roll":2.55071198897,"minCurrent":0.526,"DW flyCState":7,"offSetTime":45.33,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0652753623,"error":0.430047785168,"tickNo":47258,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":22.6202015071,"Volt4":3.556,"Volt3":3.557,"totalVolts":14.245,"Volt2":3.567,"Volt1":3.566,"Control:Throttle":0,"column115":null,"message":"47258,45.330,45200,-81.2506879097,37.2489028568,11,5,725.134460449,725.035705566,,4.5,0.0286922194064,-0.0551918707788,-1.02790522575,1.02978567634,-4.72884049072,-1.1711362516,0.748058539599,4.92880148567,-0.315816760063,-0.0945239663124,-0.276163160801,0.430047785168,473,72,1366,1447,0.619463384151,1.97275972366,0.0615912377834,2.06864914671,2.06773204541,0.00602619916424,0.997977793217,0.0237518064678,0.027976969257,-0.0518986135721,2.55071198897,3.34591143679,-6.02834111882,353.971658881,-18.7153837577,-1.29420303707,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,6.40033588714,22.6202015071,81.5304459347,73.716068867,65,6,GPS_ATTI,0,,7,1,10.832,3.566,3.567,3.557,3.556,,,14.245,0.011,154.30184,20.0,4433.0,2659.0,60,752,11,0,100,6171152927339,0.526,12.31,5.39675362319,14.194,15.713,15.0652753623,8.26346,178.53193,77.8200248841,0.0975004368037,-0.0954530542495,-6.16328181549,2.58919719184,3.36271147091,-6.03886361274,7163,7198,7262,6358,,,,,,,,,954,0,0,0,2,,,P3Standard,","directionOfTravel":81.5304459347,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_XfB","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-19.0304466712,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":2.13219198153,"MotorCmnd:Rback":6307.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.011,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.652701582,"MotorCmnd:LFront":7012.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.39675362319,"avgWatts":77.8200248841,"batteryCycles":0,"usefulTime":752,"magMod":1442,"directionOfTravelTrue":75.8800591304,"Gimbal:XYaw":-6.33605710059,"baroAltitude":725.010681152,"maxWatts":178.53193,"Current":10.832,"Watts":154.30184,"Control:Elevator":0,"batteryLife":100,"distanceHP":6.61217498008,"MotorLoad:RFront":null,"latitude":37.2489045482,"numSats":11,"Gimbal:XPitch":2.97898376054,"MotorLoad:LFront":null,"gpsAltitude":724.831115723,"minWatts":8.26346,"Yaw":-6.34729841835,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1356,"accelZ":-1.01131641865,"magY":67,"accelY":-0.0506108403206,"magX":486,"Gimbal:Roll":0.594078541507,"accelX":0.0506723634899,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.595191001892,"accel":1.013849123,"gyroX":2.60316289105,"MotorCmnd:RFront":7111.0,"gyroY":0.878286127966,"gyroZ":-2.0329750706,"velD":-0.00494964793324,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.527Z","connectedToRC":1,"flightTime":45500,"velH":2.04097089523,"MotorSpeed:RFront":null,"velE":1.95225763321,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.161792635918,"errorX":-0.0294387936592,"errorZ":-0.134947419167,"geoMagInclination":65.006715539,"Control:Aileron":1015,"percentageVolts":11,"quatZ":-0.0548357926309,"quatY":0.0250633955002,"quatX":0.020458497107,"quatW":0.997971117496,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7141.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.6832446992,"vel":2.04097689702,"MotorLoad:LBack":null,"longitude":-81.2506808315,"gyro":3.41772310137,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":0.660305016195,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.00631962225983,"Pitch":2.99832455646,"Roll":2.18265107315,"minCurrent":0.526,"DW flyCState":7,"offSetTime":45.645,"remainingCapacity":2659,"IMUTemp":64,"avgVolts":15.0652753623,"error":0.212730593825,"tickNo":47447,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":23.2763977914,"Volt4":3.556,"Volt3":3.557,"totalVolts":14.245,"Volt2":3.567,"Volt1":3.566,"Control:Throttle":0,"column115":null,"message":"47447,45.645,45500,-81.2506808315,37.2489045482,11,5,724.831115723,725.010681152,,4.5,0.0506723634899,-0.0506108403206,-1.01131641865,1.013849123,2.60316289105,0.878286127966,-2.0329750706,3.41772310137,-0.0294387936592,-0.161792635918,-0.134947419167,0.212730593825,486,67,1356,1442,0.595191001892,1.95225763321,-0.00494964793324,2.04097689702,2.04097089523,0.00631962225983,0.997971117496,0.020458497107,0.0250633955002,-0.0548357926309,2.18265107315,2.99832455646,-6.34729841835,353.652701582,-19.0304466712,-1.6832446992,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,6.61217498008,23.2763977914,83.694436198,75.8800591304,64,6,GPS_ATTI,0,,7,1,10.832,3.566,3.567,3.557,3.556,,,14.245,0.011,154.30184,20.0,4433.0,2659.0,60,752,11,0,100,6171152927339,0.526,12.31,5.39675362319,14.194,15.713,15.0652753623,8.26346,178.53193,77.8200248841,0.594078541507,0.660305016195,-6.16328181549,2.13219198153,2.97898376054,-6.33605710059,7111,7012,7141,6307,,,,,,,,,1015,0,0,0,2,,,P3Standard,","directionOfTravel":83.694436198,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_XfD","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-19.1258519181,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":2.09703326053,"MotorCmnd:Rback":6015.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.011,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.550968214,"MotorCmnd:LFront":7273.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.39675362319,"avgWatts":77.8200248841,"batteryCycles":0,"usefulTime":752,"magMod":1429,"directionOfTravelTrue":73.085414552,"Gimbal:XYaw":-6.44753297526,"baroAltitude":725.013122559,"maxWatts":178.53193,"Current":10.832,"Watts":154.30184,"Control:Elevator":0,"batteryLife":100,"distanceHP":6.66798136047,"MotorLoad:RFront":null,"latitude":37.2489049358,"numSats":11,"Gimbal:XPitch":2.97143812269,"MotorLoad:LFront":null,"gpsAltitude":724.74786377,"minWatts":8.26346,"Yaw":-6.44903178631,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1343,"accelZ":-0.996675312519,"magY":62,"accelY":-0.0669891238213,"magX":486,"Gimbal:Roll":0.669069963169,"accelX":0.0305748675019,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.587649405003,"accel":0.999391836978,"gyroX":-5.40649728234,"MotorCmnd:RFront":6933.0,"gyroY":2.21362589019,"gyroZ":-0.619392823397,"velD":-0.0113188736141,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.527Z","connectedToRC":1,"flightTime":45600,"velH":2.02594583559,"MotorSpeed:RFront":null,"velE":1.93884623051,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.337736219168,"errorX":-0.252147138119,"errorZ":0.0278896391392,"geoMagInclination":65.006715539,"Control:Aileron":1015,"percentageVolts":11,"quatZ":-0.0557569824159,"quatY":0.0250306669623,"quatX":0.0192415565252,"quatW":0.997945129871,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7326.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.55748243714,"vel":2.02597745438,"MotorLoad:LBack":null,"longitude":-81.2506792987,"gyro":5.87486169329,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":0.753551185631,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":-0.00124552227619,"Pitch":2.98859878344,"Roll":2.04089256897,"minCurrent":0.526,"DW flyCState":7,"offSetTime":45.715,"remainingCapacity":2659,"IMUTemp":64,"avgVolts":15.0652753623,"error":0.422400005884,"tickNo":47489,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":23.4914025077,"Volt4":3.556,"Volt3":3.557,"totalVolts":14.245,"Volt2":3.567,"Volt1":3.566,"Control:Throttle":0,"column115":null,"message":"47489,45.715,45600,-81.2506792987,37.2489049358,11,5,724.74786377,725.013122559,,4.5,0.0305748675019,-0.0669891238213,-0.996675312519,0.999391836978,-5.40649728234,2.21362589019,-0.619392823397,5.87486169329,-0.252147138119,-0.337736219168,0.0278896391392,0.422400005884,486,62,1343,1429,0.587649405003,1.93884623051,-0.0113188736141,2.02597745438,2.02594583559,-0.00124552227619,0.997945129871,0.0192415565252,0.0250306669623,-0.0557569824159,2.04089256897,2.98859878344,-6.44903178631,353.550968214,-19.1258519181,-1.55748243714,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,6.66798136047,23.4914025077,80.8997916196,73.085414552,64,6,GPS_ATTI,0,,7,1,10.832,3.566,3.567,3.557,3.556,,,14.245,0.011,154.30184,20.0,4433.0,2659.0,60,752,11,0,100,6171152927339,0.526,12.31,5.39675362319,14.194,15.713,15.0652753623,8.26346,178.53193,77.8200248841,0.669069963169,0.753551185631,-6.16328181549,2.09703326053,2.97143812269,-6.44753297526,6933,7273,7326,6015,,,,,,,,,1015,0,0,0,2,,,P3Standard,","directionOfTravel":80.8997916196,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_XfF","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-19.0701372486,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":1.92668946228,"MotorCmnd:Rback":6343.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.011,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.59880381,"MotorCmnd:LFront":6981.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.39675362319,"avgWatts":77.8200248841,"batteryCycles":0,"usefulTime":752,"magMod":1438,"directionOfTravelTrue":70.114841411,"Gimbal:XYaw":-6.42755734841,"baroAltitude":725.006286621,"maxWatts":178.53193,"Current":10.832,"Watts":154.30184,"Control:Elevator":0,"batteryLife":100,"distanceHP":6.73131582256,"MotorLoad:RFront":null,"latitude":37.2489053755,"numSats":11,"Gimbal:XPitch":3.14064159798,"MotorLoad:LFront":null,"gpsAltitude":724.651184082,"minWatts":8.26346,"Yaw":-6.40119619009,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1353,"accelZ":-1.00172352791,"magY":53,"accelY":-0.0555728636682,"magX":486,"Gimbal:Roll":0.811194033522,"accelX":0.0348693728447,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.578171491623,"accel":1.00386963432,"gyroX":-1.35711760695,"MotorCmnd:RFront":7164.0,"gyroY":5.5072587943,"gyroZ":1.9477556541,"velD":0.00723755545914,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.527Z","connectedToRC":1,"flightTime":45700,"velH":2.00477884909,"MotorSpeed:RFront":null,"velE":1.91959786415,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.18974968791,"errorX":-0.259773671627,"errorZ":0.0125076435506,"geoMagInclination":65.006715539,"Control:Aileron":1045,"percentageVolts":11,"quatZ":-0.0553357563913,"quatY":0.0271095745265,"quatX":0.01816849038,"quatW":0.997934401035,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7241.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-0.913291647727,"vel":2.00479191339,"MotorLoad:LBack":null,"longitude":-81.2506778356,"gyro":5.9971176172,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":0.426242170662,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":-0.0658239456623,"Pitch":3.21879107874,"Roll":1.90610436674,"minCurrent":0.526,"DW flyCState":7,"offSetTime":45.785,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0652753623,"error":0.321937487223,"tickNo":47531,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":23.7006510982,"Volt4":3.556,"Volt3":3.557,"totalVolts":14.245,"Volt2":3.567,"Volt1":3.566,"Control:Throttle":0,"column115":null,"message":"47531,45.785,45700,-81.2506778356,37.2489053755,11,5,724.651184082,725.006286621,,4.5,0.0348693728447,-0.0555728636682,-1.00172352791,1.00386963432,-1.35711760695,5.5072587943,1.9477556541,5.9971176172,-0.259773671627,-0.18974968791,0.0125076435506,0.321937487223,486,53,1353,1438,0.578171491623,1.91959786415,0.00723755545914,2.00479191339,2.00477884909,-0.0658239456623,0.997934401035,0.01816849038,0.0271095745265,-0.0553357563913,1.90610436674,3.21879107874,-6.40119619009,353.59880381,-19.0701372486,-0.913291647727,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,6.73131582256,23.7006510982,77.9292184786,70.114841411,65,6,GPS_ATTI,0,,7,1,10.832,3.566,3.567,3.557,3.556,,,14.245,0.011,154.30184,20.0,4433.0,2659.0,60,752,11,0,100,6171152927339,0.526,12.31,5.39675362319,14.194,15.713,15.0652753623,8.26346,178.53193,77.8200248841,0.811194033522,0.426242170662,-6.16328181549,1.92668946228,3.14064159798,-6.42755734841,7164,6981,7241,6343,,,,,,,,,1045,0,0,0,2,,,P3Standard,","directionOfTravel":77.9292184786,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_XfS","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.8541276587,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.58505806764,"MotorCmnd:Rback":6493.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.009,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.891766835,"MotorCmnd:LFront":7050.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.48184285714,"avgWatts":79.0105364571,"batteryCycles":0,"usefulTime":752,"magMod":1449,"directionOfTravelTrue":76.0804968378,"Gimbal:XYaw":-6.15057830531,"baroAltitude":724.972473145,"maxWatts":178.53193,"Current":11.353,"Watts":161.155835,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.10919612111,"MotorLoad:RFront":null,"latitude":37.2489074144,"numSats":11,"Gimbal:XPitch":3.84650979376,"MotorLoad:LFront":null,"gpsAltitude":724.295227051,"minWatts":8.26346,"Yaw":-6.10823316465,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1369,"accelZ":-1.04196834564,"magY":26,"accelY":-0.052349627018,"magX":477,"Gimbal:Roll":2.59619140235,"accelX":0.00377846788615,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.429682999849,"accel":1.04328941027,"gyroX":-5.98783816137,"MotorCmnd:RFront":6630.0,"gyroY":10.306836566,"gyroZ":0.847901604556,"velD":0.0314313955605,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.529Z","connectedToRC":1,"flightTime":46100,"velH":1.82674284425,"MotorSpeed:RFront":null,"velE":1.77548921108,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.338573217392,"errorX":-0.707830667496,"errorZ":-0.392076939344,"geoMagInclination":65.006715539,"Control:Aileron":787,"percentageVolts":10,"quatZ":-0.053114566952,"quatY":0.0349905230105,"quatX":0.00559615436941,"quatW":0.997959494591,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7678.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.6088504305,"vel":1.82701323248,"MotorLoad:LBack":null,"longitude":-81.2506681719,"gyro":11.9500637227,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":-1.05000903653,"gpsHealth":5,"relativeHeight":"4.4","velGPS-velH":0.0114853281355,"Pitch":4.03895416885,"Roll":0.426998348051,"minCurrent":0.526,"DW flyCState":7,"offSetTime":46.24,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0528428571,"error":0.877143319959,"tickNo":47804,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":24.5214665112,"Volt4":3.544,"Volt3":3.544,"totalVolts":14.195,"Volt2":3.553,"Volt1":3.552,"Control:Throttle":0,"column115":null,"message":"47804,46.240,46100,-81.2506681719,37.2489074144,11,5,724.295227051,724.972473145,,4.4,0.00377846788615,-0.052349627018,-1.04196834564,1.04328941027,-5.98783816137,10.306836566,0.847901604556,11.9500637227,-0.707830667496,-0.338573217392,-0.392076939344,0.877143319959,477,26,1369,1449,0.429682999849,1.77548921108,0.0314313955605,1.82701323248,1.82674284425,0.0114853281355,0.997959494591,0.00559615436941,0.0349905230105,-0.053114566952,0.426998348051,4.03895416885,-6.10823316465,353.891766835,-18.8541276587,-1.6088504305,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.10919612111,24.5214665112,83.8948739055,76.0804968378,65,6,GPS_ATTI,0,,7,1,11.353,3.552,3.553,3.544,3.544,,,14.195,0.009,161.155835,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.48184285714,14.194,15.713,15.0528428571,8.26346,178.53193,79.0105364571,2.59619140235,-1.05000903653,-6.16328181549,0.58505806764,3.84650979376,-6.15057830531,6630,7050,7678,6493,,,,,,,,,787,0,0,0,2,,,P3Standard,","directionOfTravel":83.8948739055,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_XfW","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.6076070796,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.31522447443,"MotorCmnd:Rback":6147.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.009,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":354.153112114,"MotorCmnd:LFront":7109.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.48184285714,"avgWatts":79.0105364571,"batteryCycles":0,"usefulTime":752,"magMod":1451,"directionOfTravelTrue":76.6501342734,"Gimbal:XYaw":-5.89321952926,"baroAltitude":724.989074707,"maxWatts":178.53193,"Current":11.353,"Watts":161.155835,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.22398176974,"MotorLoad:RFront":null,"latitude":37.2489079145,"numSats":11,"Gimbal:XPitch":4.52415183611,"MotorLoad:LFront":null,"gpsAltitude":724.964111328,"minWatts":8.26346,"Yaw":-5.84688788578,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1376,"accelZ":-1.01348733902,"magY":21,"accelY":-0.0672142729163,"magX":461,"Gimbal:Roll":2.69386993767,"accelX":3.53592913598E-4,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.339662700891,"accel":1.01571377359,"gyroX":-7.22229240102,"MotorCmnd:RFront":6391.0,"gyroY":6.46691403306,"gyroZ":2.38861106785,"velD":-0.0508787557483,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.529Z","connectedToRC":1,"flightTime":46300,"velH":1.7394396979,"MotorSpeed:RFront":null,"velE":1.70595419407,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.536880791187,"errorX":-0.890929460526,"errorZ":-0.0450110509992,"geoMagInclination":65.006715539,"Control:Aileron":939,"percentageVolts":10,"quatZ":-0.0508861318231,"quatY":0.0400756448507,"quatX":0.00389201752841,"quatW":0.99789249897,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7637.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.61528861845,"vel":1.74018364273,"MotorLoad:LBack":null,"longitude":-81.2506654369,"gyro":9.98438518239,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":-1.8836492061,"gpsHealth":5,"relativeHeight":"4.4","velGPS-velH":-0.204730440119,"Pitch":4.61035197807,"Roll":0.211366955885,"minCurrent":0.526,"DW flyCState":7,"offSetTime":46.38,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0528428571,"error":1.0411639075,"tickNo":47888,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":24.7125255983,"Volt4":3.544,"Volt3":3.544,"totalVolts":14.195,"Volt2":3.553,"Volt1":3.552,"Control:Throttle":0,"column115":null,"message":"47888,46.380,46300,-81.2506654369,37.2489079145,11,5,724.964111328,724.989074707,,4.4,0.000353592913598,-0.0672142729163,-1.01348733902,1.01571377359,-7.22229240102,6.46691403306,2.38861106785,9.98438518239,-0.890929460526,-0.536880791187,-0.0450110509992,1.0411639075,461,21,1376,1451,0.339662700891,1.70595419407,-0.0508787557483,1.74018364273,1.7394396979,-0.204730440119,0.99789249897,0.00389201752841,0.0400756448507,-0.0508861318231,0.211366955885,4.61035197807,-5.84688788578,354.153112114,-18.6076070796,-1.61528861845,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.22398176974,24.7125255983,84.4645113411,76.6501342734,65,6,GPS_ATTI,0,,7,1,11.353,3.552,3.553,3.544,3.544,,,14.195,0.009,161.155835,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.48184285714,14.194,15.713,15.0528428571,8.26346,178.53193,79.0105364571,2.69386993767,-1.8836492061,-6.16328181549,0.31522447443,4.52415183611,-5.89321952926,6391,7109,7637,6147,,,,,,,,,939,0,0,0,2,,,P3Standard,","directionOfTravel":84.4645113411,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_Xfj","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-17.9121410442,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.922093327833,"MotorCmnd:Rback":6358.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.009,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":354.753868999,"MotorCmnd:LFront":7162.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.48184285714,"avgWatts":79.0105364571,"batteryCycles":0,"usefulTime":752,"magMod":1431,"directionOfTravelTrue":88.5232933577,"Gimbal:XYaw":-5.26056090384,"baroAltitude":725.037841797,"maxWatts":178.53193,"Current":11.353,"Watts":161.155835,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.52213555587,"MotorLoad:RFront":null,"latitude":37.2489086141,"numSats":11,"Gimbal:XPitch":4.00022128514,"MotorLoad:LFront":null,"gpsAltitude":725.039672852,"minWatts":8.26346,"Yaw":-5.24613100067,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1353,"accelZ":-0.991419672966,"magY":21,"accelY":-0.0613294020295,"magX":467,"Gimbal:Roll":1.17721800145,"accelX":0.0183825157583,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.0792694985867,"accel":0.993484866711,"gyroX":0.530040235314,"MotorCmnd:RFront":6917.0,"gyroY":-4.31435344915,"gyroZ":1.85922829161,"velD":-0.0129519905895,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.530Z","connectedToRC":1,"flightTime":46700,"velH":1.51058712628,"MotorSpeed:RFront":null,"velE":1.50850582123,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.392847061157,"errorX":-0.539821743965,"errorZ":0.114222444594,"geoMagInclination":65.006715539,"Control:Aileron":787,"percentageVolts":10,"quatZ":-0.0454564839602,"quatY":0.0340621061623,"quatX":0.00969371758401,"quatW":0.998338460922,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7136.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":0.0435668119514,"vel":1.51064265137,"MotorLoad:LBack":null,"longitude":-81.2506572704,"gyro":4.72771807277,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":-1.49492926661,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.0052596111872,"Pitch":3.95089047283,"Roll":0.931586325363,"minCurrent":0.526,"DW flyCState":7,"offSetTime":46.835,"remainingCapacity":2659,"IMUTemp":64,"avgVolts":15.0528428571,"error":0.67733529036,"tickNo":48161,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":25.5622024952,"Volt4":3.544,"Volt3":3.544,"totalVolts":14.195,"Volt2":3.553,"Volt1":3.552,"Control:Throttle":0,"column115":null,"message":"48161,46.835,46700,-81.2506572704,37.2489086141,11,5,725.039672852,725.037841797,,4.5,0.0183825157583,-0.0613294020295,-0.991419672966,0.993484866711,0.530040235314,-4.31435344915,1.85922829161,4.72771807277,-0.539821743965,-0.392847061157,0.114222444594,0.67733529036,467,21,1353,1431,0.0792694985867,1.50850582123,-0.0129519905895,1.51064265137,1.51058712628,0.0052596111872,0.998338460922,0.00969371758401,0.0340621061623,-0.0454564839602,0.931586325363,3.95089047283,-5.24613100067,354.753868999,-17.9121410442,0.0435668119514,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.52213555587,25.5622024952,96.3376704254,88.5232933577,64,6,GPS_ATTI,0,,7,1,11.353,3.552,3.553,3.544,3.544,,,14.195,0.009,161.155835,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.48184285714,14.194,15.713,15.0528428571,8.26346,178.53193,79.0105364571,1.17721800145,-1.49492926661,-6.16328181549,0.922093327833,4.00022128514,-5.26056090384,6917,7162,7136,6358,,,,,,,,,787,0,0,0,2,,,P3Standard,","directionOfTravel":96.3376704254,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_Xfm","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.0834423514,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.906983040965,"MotorCmnd:Rback":6152.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.008,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":354.570410845,"MotorCmnd:LFront":7157.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.56483098592,"avgWatts":80.1729925915,"batteryCycles":0,"usefulTime":752,"magMod":1436,"directionOfTravelTrue":85.4035139956,"Gimbal:XYaw":-5.38577805288,"baroAltitude":725.04309082,"maxWatts":178.53193,"Current":11.374,"Watts":161.544922,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.59194874627,"MotorLoad:RFront":null,"latitude":37.2489087299,"numSats":11,"Gimbal:XPitch":3.69411635681,"MotorLoad:LFront":null,"gpsAltitude":724.987060547,"minWatts":8.26346,"Yaw":-5.42958915463,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1356,"accelZ":-1.01219391823,"magY":35,"accelY":-0.0668116360903,"magX":473,"Gimbal:Roll":0.770582849295,"accelX":0.0125804115087,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":0.0225710719824,"accel":1.01447453865,"gyroX":-5.62855697754,"MotorCmnd:RFront":6851.0,"gyroY":1.37219055378,"gyroZ":-2.50450144882,"velD":-0.0088816024363,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.530Z","connectedToRC":1,"flightTime":46800,"velH":1.46774231539,"MotorSpeed:RFront":null,"velE":1.46756875515,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.43065816164,"errorX":-0.576259434223,"errorZ":-0.0836682021618,"geoMagInclination":65.006715539,"Control:Aileron":757,"percentageVolts":10,"quatZ":-0.0471069440246,"quatY":0.0319488458335,"quatX":0.00868768338114,"quatW":0.998341023922,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7344.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.64122233966,"vel":1.46776918732,"MotorLoad:LBack":null,"longitude":-81.2506554618,"gyro":6.3115836422,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":-1.32669925276,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.134863160351,"Pitch":3.70485276561,"Roll":0.821449970727,"minCurrent":0.526,"DW flyCState":7,"offSetTime":46.94,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0408732394,"error":0.724252549717,"tickNo":48224,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":25.7227999074,"Volt4":3.548,"Volt3":3.548,"totalVolts":14.203,"Volt2":3.556,"Volt1":3.551,"Control:Throttle":0,"column115":null,"message":"48224,46.940,46800,-81.2506554618,37.2489087299,11,5,724.987060547,725.04309082,,4.5,0.0125804115087,-0.0668116360903,-1.01219391823,1.01447453865,-5.62855697754,1.37219055378,-2.50450144882,6.3115836422,-0.576259434223,-0.43065816164,-0.0836682021618,0.724252549717,473,35,1356,1436,0.0225710719824,1.46756875515,-0.0088816024363,1.46776918732,1.46774231539,0.134863160351,0.998341023922,0.00868768338114,0.0319488458335,-0.0471069440246,0.821449970727,3.70485276561,-5.42958915463,354.570410845,-18.0834423514,-1.64122233966,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.59194874627,25.7227999074,93.2178910633,85.4035139956,65,6,GPS_ATTI,0,,7,1,11.374,3.551,3.556,3.548,3.548,,,14.203,0.008,161.544922,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.56483098592,14.194,15.713,15.0408732394,8.26346,178.53193,80.1729925915,0.770582849295,-1.32669925276,-6.16328181549,0.906983040965,3.69411635681,-5.38577805288,6851,7157,7344,6152,,,,,,,,,757,0,0,0,2,,,P3Standard,","directionOfTravel":93.2178910633,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_Xfw","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.7714522019,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.554961119715,"MotorCmnd:Rback":6074.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.008,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.820061269,"MotorCmnd:LFront":7025.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.56483098592,"avgWatts":80.1729925915,"batteryCycles":0,"usefulTime":752,"magMod":1455,"directionOfTravelTrue":90.5867547568,"Gimbal:XYaw":-6.16692936346,"baroAltitude":725.035644531,"maxWatts":178.53193,"Current":11.374,"Watts":161.544922,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.76351645586,"MotorLoad:RFront":null,"latitude":37.2489085458,"numSats":11,"Gimbal:XPitch":2.08730266323,"MotorLoad:LFront":null,"gpsAltitude":724.493286133,"minWatts":8.26346,"Yaw":-6.1799387314,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1359,"accelZ":-1.00074899197,"magY":35,"accelY":-0.0381997972727,"magX":519,"Gimbal:Roll":-1.23529115126,"accelX":0.0210947524756,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":-0.0622721984982,"accel":1.00169993412,"gyroX":3.65008340142,"MotorCmnd:RFront":7145.0,"gyroY":-4.20942125293,"gyroZ":-1.8552161958,"velD":0.00750657636672,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.531Z","connectedToRC":1,"flightTime":47200,"velH":1.33789796357,"MotorSpeed:RFront":null,"velE":1.33644795418,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.16581107676,"errorX":-0.235628724098,"errorZ":0.0782752335072,"geoMagInclination":65.006715539,"Control:Aileron":272,"percentageVolts":10,"quatZ":-0.053804077208,"quatY":0.0177017282695,"quatX":0.00599767081439,"quatW":0.998376607895,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7161.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-2.17021796092,"vel":1.33791902207,"MotorLoad:LBack":null,"longitude":-81.2506500465,"gyro":5.87232179424,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":0.766481053894,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.00556647570453,"Pitch":2.06270436272,"Roll":0.577036560901,"minCurrent":0.526,"DW flyCState":7,"offSetTime":47.29,"remainingCapacity":2659,"IMUTemp":65,"avgVolts":15.0408732394,"error":0.298565270883,"tickNo":48434,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":26.1559040815,"Volt4":3.548,"Volt3":3.548,"totalVolts":14.203,"Volt2":3.556,"Volt1":3.551,"Control:Throttle":0,"column115":null,"message":"48434,47.290,47200,-81.2506500465,37.2489085458,11,5,724.493286133,725.035644531,,4.5,0.0210947524756,-0.0381997972727,-1.00074899197,1.00169993412,3.65008340142,-4.20942125293,-1.8552161958,5.87232179424,-0.235628724098,-0.16581107676,0.0782752335072,0.298565270883,519,35,1359,1455,-0.0622721984982,1.33644795418,0.00750657636672,1.33791902207,1.33789796357,0.00556647570453,0.998376607895,0.00599767081439,0.0177017282695,-0.053804077208,0.577036560901,2.06270436272,-6.1799387314,353.820061269,-18.7714522019,-2.17021796092,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.76351645586,26.1559040815,98.4011318245,90.5867547568,65,6,GPS_ATTI,0,,7,1,11.374,3.551,3.556,3.548,3.548,,,14.203,0.008,161.544922,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.56483098592,14.194,15.713,15.0408732394,8.26346,178.53193,80.1729925915,-1.23529115126,0.766481053894,-6.16328181549,0.554961119715,2.08730266323,-6.16692936346,7145,7025,7161,6074,,,,,,,,,272,0,0,0,2,,,P3Standard,","directionOfTravel":98.4011318245,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}},
        //       {"_index":"uav_index","_type":"logs","_id":"AVq4GMEE_qINWNwL_Xfy","_score":1.0,"_source":{"MotorSpeed:LFront":null,"totalGyroZ":-18.779670615,"batteryBarCode":6.171152927339E12,"Control:ModeSwitch":2,"Gimbal:XRoll":0.635157729037,"MotorCmnd:Rback":6240.0,"MotorSpeed:LBack":null,"Control:Rudder":0,"voltSpread":0.008,"path":"/Users/kovar/devel/logstash-5.2.2/logs/uav.log","Yaw360":353.802514194,"MotorCmnd:LFront":7169.0,"MotorLoad:Rback":null,"batteryTemp":20,"avgCurrent":5.56483098592,"avgWatts":80.1729925915,"batteryCycles":0,"usefulTime":752,"magMod":1449,"directionOfTravelTrue":93.0165248249,"Gimbal:XYaw":-6.22503581389,"baroAltitude":725.04107666,"maxWatts":178.53193,"Current":11.374,"Watts":161.544922,"Control:Elevator":0,"batteryLife":100,"distanceHP":7.7984411381,"MotorLoad:RFront":null,"latitude":37.248908499,"numSats":11,"Gimbal:XPitch":2.12221946305,"MotorLoad:LFront":null,"gpsAltitude":724.957397461,"minWatts":8.26346,"Yaw":-6.19748580591,"Gimbal:Yaw":-6.16328181549,"tabletLatitude":null,"magZ":1356,"accelZ":-0.983292460442,"magY":26,"accelY":-0.0617621950805,"magX":512,"Gimbal:Roll":-2.70609811071,"accelX":0.0301866512746,"flyCState-String":"GPS_ATTI","tabletLongitude":null,"thrustAngle":-45,"maxVolts":15.713,"velN":-0.0796291008592,"accel":0.985692581598,"gyroX":-12.9834937867,"MotorCmnd:RFront":6634.0,"gyroY":5.75118107126,"gyroZ":1.16409443329,"velD":-0.00373801030219,"flyCState":6,"homePointAltitude":740.5,"@timestamp":"2017-03-10T12:01:51.531Z","connectedToRC":1,"flightTime":47200,"velH":1.30302613248,"MotorSpeed:RFront":null,"velE":1.30059075356,"homePointLongitude":-81.2506872,"percentageCapacity":60,"errorY":-0.577080726624,"errorX":-0.121716380119,"errorZ":0.151674002409,"geoMagInclination":65.006715539,"Control:Aileron":151,"percentageVolts":10,"quatZ":-0.0539602339268,"quatY":0.0189388468862,"quatX":0.00552218360826,"quatW":0.998348236084,"ratedCapacity":4433,"minVolts":14.194,"MotorCmnd:LBack":7393.0,"MotorSpeed:Rback":null,"host":"Praha","vpsHeight":null,"magYaw":-1.4231517631,"vel":1.30303149412,"MotorLoad:LBack":null,"longitude":-81.2506490021,"gyro":14.2478879302,"maxCurrent ":12.31,"nonGPSCause":0,"Gimbal:Pitch":0.220064039323,"gpsHealth":5,"relativeHeight":"4.5","velGPS-velH":0.0105498093944,"Pitch":2.20142347037,"Roll":0.514651052475,"minCurrent":0.526,"DW flyCState":7,"offSetTime":47.36,"remainingCapacity":2659,"IMUTemp":64,"avgVolts":15.0408732394,"error":0.608968016596,"tickNo":48476,"@version":"1","geoMagDeclination":-7.81437706766,"Volt6":null,"Volt5":null,"distanceTraveled":26.2955111985,"Volt4":3.548,"Volt3":3.548,"totalVolts":14.203,"Volt2":3.556,"Volt1":3.551,"Control:Throttle":0,"column115":null,"message":"48476,47.360,47200,-81.2506490021,37.248908499,11,5,724.957397461,725.04107666,,4.5,0.0301866512746,-0.0617621950805,-0.983292460442,0.985692581598,-12.9834937867,5.75118107126,1.16409443329,14.2478879302,-0.121716380119,-0.577080726624,0.151674002409,0.608968016596,512,26,1356,1449,-0.0796291008592,1.30059075356,-0.00373801030219,1.30303149412,1.30302613248,0.0105498093944,0.998348236084,0.00552218360826,0.0189388468862,-0.0539602339268,0.514651052475,2.20142347037,-6.19748580591,353.802514194,-18.779670615,-1.4231517631,-45.0,-81.2506872,37.2488453,740.5,-7.81437706766,65.006715539,7.7984411381,26.2955111985,100.830901893,93.0165248249,64,6,GPS_ATTI,0,,7,1,11.374,3.551,3.556,3.548,3.548,,,14.203,0.008,161.544922,20.0,4433.0,2659.0,60,752,10,0,100,6171152927339,0.526,12.31,5.56483098592,14.194,15.713,15.0408732394,8.26346,178.53193,80.1729925915,-2.70609811071,0.220064039323,-6.16328181549,0.635157729037,2.12221946305,-6.22503581389,6634,7169,7393,6240,,,,,,,,,151,0,0,0,2,,,P3Standard,","directionOfTravel":100.830901893,"nonGPSCause-String":null,"homePointLatitude":37.2488453,"A/C model":"P3Standard"}}
        //   ];

        // deferred.resolve(mockResults);
        return deferred.promise;
  }

  $scope.getLogData({}).then(function(data){

    var tableData = []

    for (var i = 0; i < data.length; i++) {
      tableData.push(data[i]._source);
    }

    $scope.logData = tableData;
    $scope.getAltitudeDataSeries();
  });

  $scope.getAltitudeDataSeries = function() {
    for (var i = 0; i < $scope.logData.length; i++) {

      var timestamp = moment($scope.logData[i]['@timestamp']).valueOf()*1000;

      $scope.altitudeChart.series[0].data.push([ timestamp, $scope.logData[i].gpsHealth]);
      $scope.altitudeChart.series[1].data.push([ timestamp, $scope.logData[i].gpsAltitude]);
      $scope.altitudeChart.series[2].data.push([ timestamp, $scope.logData[i].baroAltitude]);
    }
  }

};


})();
